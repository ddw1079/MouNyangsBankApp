<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<!-- headr footer가 달리는 모든 페이지에 갖다 붙일것 -->
<link rel="icon" href="http://localhost:8810/images/cat.ico" type="image/x-icon" />
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="http://localhost:8810/css/header-footer.css" />
<script defer src="http://localhost:8810/js/token-exp-display.js"></script>
<script defer src="http://localhost:8810/js/common.js"></script>
<script defer src="http://localhost:8810/js/adminservice.js"></script>
<script defer src="http://localhost:8810/js/bankservice.js"></script>
<script defer src="http://localhost:8810/js/cardservice.js"></script>
<script defer src="http://localhost:8810/js/transactionservice.js"></script>
<!-- 이것도 같이 붙여야함 toggle switch 만들기 -->
<link rel="stylesheet" href="http://localhost:8810/css/theme.css">
<link rel="stylesheet" href="http://localhost:8810/css/toggle.css">
<script defer src="http://localhost:8810/js/theme.js"></script>

<link rel="stylesheet" href="/css/card-manage.css" />
</head>
<body>
	<div id="header"></div>
	<main class="m-layout">
		<!-- 좌: 내 카드 -->
		<aside class="m-drawer" aria-label="내 카드">
			<div class="m-search">
				<input type="search" placeholder="카드 검색" />
			</div>
			<ul id="cardListM" class="m-list" role="listbox" aria-label="카드 선택"></ul>
			<button id="addCard" class="m-add">+ 새 카드 추천</button>
		</aside>

		<!-- 중: 대시보드 -->
		<section class="m-main">
			<header class="m-heading">
				<h1 id="cardTitle">카드 관리</h1>
				<span id="cardState" class="badge">-</span>
			</header>

			<!-- 빠른 작업 -->
			<div class="quickbar">
				<button class="qbtn" data-go="tx">이용내역</button>
				<button class="qbtn" data-go="limit">한도관리</button>
				<button class="qbtn qbtn-ghost" id="freezeToggle">정지/해제</button>
				<button class="qbtn qbtn-danger" id="closeCard">카드 해지</button>
			</div>

			<!-- KPI 3장 -->
			<section class="kpis">
				<article class="kpi">
					<div class="kpi-h">이번 달 한도</div>
					<div id="limitText">-</div>
					<div class="progress">
						<div class="progress-track">
							<div class="progress-bar" id="limitBar" style="width: 0%"></div>
						</div>
						<div class="progress-label" id="limitLabel">0%</div>
					</div>
				</article>
				<article class="kpi">
					<div class="kpi-h">포인트</div>
					<div id="pointText">-</div>
				</article>
				<article class="kpi">
					<div class="kpi-h">다음 납부일</div>
					<div id="nextText">-</div>
				</article>
			</section>

			<!-- 탭: 대시보드/이용내역/한도/보안/설정 -->
			<nav class="m-tabs" role="tablist" aria-label="관리 메뉴">
				<button class="is-on" data-tab="overview" role="tab" aria-selected="true">대시보드</button>
				<button data-tab="tx" role="tab">이용내역</button>
				<button data-tab="limit" role="tab">한도관리</button>
				<button data-tab="security" role="tab">보안</button>
				<button data-tab="settings" role="tab">설정</button>
			</nav>

			<!-- 대시보드(간단 공지/추천 박스 등 확장 자리) -->
			<section id="tab-overview" class="m-tab is-on" role="tabpanel">
				<div class="grid2">
					<div class="box">
						<strong>알림</strong>
						<p class="hint">카드 상태 변경, 한도 초과 임박 등 알림을 여기에 표시합니다.</p>
					</div>
					<div class="box">
						<strong>추천</strong>
						<p class="hint">최근 소비를 기반으로 혜택이 더 높은 카드/카테고리를 제안합니다.</p>
					</div>
				</div>
			</section>

			<!-- 이용내역 -->
			<section id="tab-tx" class="m-tab" role="tabpanel">
				<div class="filters">
					<button class="chip is-on" data-filter="month:cur">이번 달</button>
					<button class="chip" data-filter="month:prev">지난 달</button>
					<button class="chip" data-filter="cat:편의점">편의점</button>
					<button class="chip" data-filter="cat:배달앱">배달앱</button>
					<button class="chip" data-filter="reset">필터 초기화</button>
				</div>
				<table class="tx">
					<thead>
						<tr>
							<th>일자</th>
							<th>가맹점</th>
							<th>카테고리</th>
							<th class="r">금액</th>
						</tr>
					</thead>
					<tbody id="txBody"></tbody>
				</table>
			</section>

			<!-- 한도관리 -->
			<section id="tab-limit" class="m-tab" role="tabpanel">
				<div class="box">
					<strong>추천 단계</strong>
					<div class="chips" id="limitChips">
						<button class="chip" data-v="500000">50만</button>
						<button class="chip" data-v="1000000">100만</button>
						<button class="chip" data-v="2000000">200만</button>
						<button class="chip" data-v="3000000">300만</button>
					</div>
					<div class="limit-ctl">
						<input id="limitRange" type="range" min="0" max="3000000" step="50000"> <input id="limitInput" class="num" type="text" placeholder="₩">
					</div>
					<div class="hint">적용 시 즉시 한도가 갱신됩니다. (서버 API 연동 지점)</div>
				</div>
			</section>

			<!-- 보안 -->
			<section id="tab-security" class="m-tab" role="tabpanel">
				<div class="box row">
					<button id="revealBtn" class="btn">카드번호 보기(5초)</button>
					<button id="pinBtn" class="btn">PIN 변경</button>
					<button id="vcardBtn" class="btn">버추얼카드 발급</button>
				</div>
				<div id="revealArea" class="reveal hide" aria-live="polite"></div>
			</section>

			<!-- 설정 (해지 진입 등) -->
			<section id="tab-settings" class="m-tab" role="tabpanel">
				<div class="box">
					<strong>카드 해지</strong>
					<p class="hint">해지는 되돌릴 수 없습니다. 자동결제 이전을 먼저 확인하세요.</p>
					<button class="qbtn qbtn-danger" id="closeCard2">해지 진행</button>
				</div>
			</section>
		</section>

		<!-- 우: 프리뷰 & 로그 -->
		<aside class="m-preview">
			<div class="cover" id="cover"></div>
			<ul id="activity" class="log"></ul>
		</aside>

		<!-- 해지 모달 -->
		<dialog id="closeModal">
		<form method="dialog" class="modal">
			<h3>카드 해지</h3>
			<p class="hint">해지 전 확인</p>
			<ul class="checklist">
				<li><label><input type="checkbox" required> 잔액 0원</label></li>
				<li><label><input type="checkbox" required> 미청구 내역 없음</label></li>
				<li><label><input type="checkbox" required> 자동결제 이전 완료</label></li>
			</ul>
			<label>카드 마지막 4자리<input id="last4" pattern="\\d{4}" required></label>
			<menu>
				<button value="cancel">취소</button>
				<button class="qbtn qbtn-danger" value="ok">영구 해지</button>
			</menu>
		</form>
		</dialog>
	</main>

	<div id="footer"></div>
	<script src="/js/card-manage.js"></script>
</body>

</html>