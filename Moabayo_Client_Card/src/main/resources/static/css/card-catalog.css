/* ==========================================================================
   Card Catalog – Clean Full Replace
   - 그리드는 고정, 배너만 컨테이너 폭에 맞추도록 정리
   - 중복 :root 제거 / 사이즈 토큰 한 곳으로 통합
   ========================================================================== */

/* ===== Theme tokens ===== */
:root{
  --bg:#ffffff; --ink:#111827; --sub:#6b7280; --line:#e5e7eb;
  --card:#ffffff; --muted:#f8fafc; --shadow:0 10px 20px rgba(15,23,42,.08);

  /* 브랜드/버튼 폴백 (사이트 공통 토큰 없을 때 사용) */
  --brand:#7c3aed; --brand-ink:#f5f3ff;

  /* 레이아웃 공통 */
  --container: 1160px;        /* 컨테이너 폭 (배너/헤드/그리드 공통) */
  --page-x-pad: 24px;

  /* 카드 그리드 타일/썸네일 */
  --tile-min: 340px;          /* 한 칸 최소 너비 */
  --thumb-ratio: 20/9;        /* 썸네일 비율 */

  /* 배너 레이아웃 */
  --banner-left: 1.15fr;
  --banner-right: .85fr;
  --ring-size: 92px;
}
[data-theme="dark"]{
  --bg:#0b0f14; --ink:#e5e7eb; --sub:#9aa5b1; --line:#1f2937;
  --card:#0f151c; --muted:#0b1016; --shadow:0 14px 28px rgba(0,0,0,.45);

  --brand:#8b7cf5; --brand-ink:#0b0f12;
}

/* ===== Base ===== */
html,body{margin:0;background:var(--bg);color:var(--ink);}
.catalog{font-family:"Pretendard",system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR";}

/* ===== Page head (컨테이너 정렬) ===== */
.head{
  max-width: var(--container);
  margin:26px auto 8px;
  padding:0 var(--page-x-pad);
}
.head h1{margin:0 0 2px;font-weight:900;letter-spacing:-.02em}
.head .sub{margin:0 0 10px;color:var(--sub)}
.controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{height:32px;padding:0 12px;border-radius:999px;border:1px solid var(--line);background:var(--card);color:var(--ink);font-weight:700}
.chip.is-active{
  background:color-mix(in oklab, var(--card) 70%, var(--muted) 30%);
  border-color:color-mix(in oklab, var(--line) 60%, var(--ink) 40%);
}
.search{margin-left:auto}
.search input{height:34px;border:1px solid var(--line);border-radius:10px;background:var(--card);color:var(--ink);padding:0 10px}

/* ===== Promo Banner (배너만 컨테이너 폭에 맞춤) ===== */
.catalog-banner{
  position: relative; overflow: hidden;
  max-width: var(--container);
  margin: 12px auto 20px;
  padding: 0 var(--page-x-pad); /* 컨테이너 좌우선과 라인 맞춤 */
  border: 0; /* 내부 카드 상자에 선/그림자 적용 */
}
.catalog-banner .cb-shell{
  position:relative; overflow:hidden;
  border:1px solid var(--line); border-radius:16px; background:var(--card);
  box-shadow: 0 10px 24px rgba(0,0,0,.08);
}
.catalog-banner .cb-content{
  position: relative; z-index: 1;
  display: grid;
  grid-template-columns: var(--banner-left) var(--banner-right);
  gap: 20px;
  padding: clamp(16px,2.4vw,28px);
  align-items: center;
}
@media (max-width: 980px){
  .catalog-banner .cb-content{ grid-template-columns: 1fr; }
}
.catalog-banner .cb-bg{
  position: absolute; inset: -10%;
  background:
    radial-gradient(600px 380px at 20% 10%, color-mix(in oklab, var(--brand), transparent 78%), transparent 60%),
    radial-gradient(520px 360px at 80% 20%, rgba(255,205,140,.16), transparent 60%),
    radial-gradient(480px 420px at 60% 90%, rgba(110,231,255,.14), transparent 60%);
  filter: blur(2px);
  animation: cbFloat 12s ease-in-out infinite;
}
@keyframes cbFloat{
  0%,100%{ transform: translateY(0) scale(1); }
  50%{ transform: translateY(-8px) scale(1.01); }
}
.cb-left .cb-chip{
  display:inline-block; padding:6px 10px; font-size:12px;
  border-radius:999px; border:1px solid var(--line); background:var(--muted); color:var(--ink);
}
.cb-title{ margin:.4rem 0 .6rem; font-size: clamp(20px, 2.2vw, 26px); line-height:1.25 }
.cb-sub{ margin:0 0 12px; color:var(--sub) }
.cb-actions{ display:flex; gap:8px; flex-wrap:wrap; }
.mbtn{
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:999px; padding:10px 14px; font-weight:600; cursor:pointer;
  border:1px solid var(--line); background:var(--card); color:var(--ink); text-decoration:none;
}
.mbtn--primary{ border-color:transparent; background:var(--brand); color:var(--brand-ink);
  box-shadow: 0 8px 20px color-mix(in oklab, var(--brand), black 70%/25%); }
.mbtn--outline{ background:transparent }

.cb-right{ display:grid; grid-template-columns:auto 1fr; gap:12px; align-items:center; }
.cb-label{ display:block; font-size:12px; color:var(--sub); margin-bottom:4px }
.cb-stat{ display:grid; justify-items:center; gap:6px }
.cb-ring{
  --size: var(--ring-size);
  --val: 0; /* JS에서 0~100 값으로 설정 */
  width: var(--size); height: var(--size); border-radius: 50%;
  display:grid; place-items:center;
  background:
    conic-gradient(var(--brand) calc(var(--val)*1%), color-mix(in oklab, var(--brand), transparent 80%) 0);
  -webkit-mask: radial-gradient(#0000 calc(50% - 8px), #000 calc(50% - 7px));
          mask: radial-gradient(#0000 calc(50% - 8px), #000 calc(50% - 7px));
  box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--brand), black 35%/20%);
}
.cb-ring > span{ font-weight:700; color:var(--ink); background:var(--card); padding:2px 6px; border-radius:8px; }
.cb-list{ list-style:none; margin:0; padding:0; display:grid; gap:6px; color:var(--sub) }
.cb-list li{ padding:6px 10px; border:1px dashed color-mix(in oklab, var(--line), transparent 35%);
  border-radius:10px; background: color-mix(in oklab, var(--muted), transparent 20%); }
.cb-close{
  position:absolute; top:10px; right:10px;
  width:32px; height:32px; border-radius:999px;
  border:1px solid var(--line); background: color-mix(in oklab, var(--card), var(--muted) 25%);
  color:var(--sub); cursor:pointer;
}
.cb-close:hover{ filter: brightness(1.05); }

/* ===== Grid (컨테이너 정렬 유지) ===== */
.grid{
  max-width: var(--container);
  margin:8px auto 40px;
  padding:0 var(--page-x-pad);
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--tile-min), 1fr));
  gap:16px;
}
@media (max-width: 1400px){ .grid{ --tile-min: 320px; } }
@media (max-width: 1100px){ .grid{ --tile-min: 300px; } }
@media (max-width:  860px){ .grid{ --tile-min: 280px; --thumb-ratio: 16/9; } }

/* ===== Card (3D flip base) ===== */
.kcard{ --accent:#7c3aed; position:relative; perspective:1200px; }
.kcard .inner{
  position:relative; transform-style:preserve-3d;
  border:1px solid var(--line); border-radius:18px; background:var(--card);
  box-shadow:var(--shadow); transition:transform .2s ease, box-shadow .2s ease;
  height: clamp(220px, 34vw, 280px); /* 고정 높이 대신 반응형 높이(플립에 필요) */
}
.kcard:hover .inner{ transform:translateY(-4px); }
.kcard .face{
  position:absolute; inset:0; padding:12px 12px 14px;
  border-radius:18px; backface-visibility:hidden;
  display:flex; flex-direction:column; gap:10px; overflow:hidden;
}
.kcard .front{ z-index:2; }
.kcard .back{ transform:rotateY(180deg); z-index:3; }
.kcard.is-flipped .inner{ transform:rotateY(180deg); }

/* Thumb + meta */
.kcard .thumb{
  width:100%;
  aspect-ratio: var(--thumb-ratio);
  border-radius:12px; border:1px solid var(--line);
  background:
    radial-gradient(100% 140% at 0% 0%, color-mix(in oklab, var(--accent) 26%, transparent), transparent 60%),
    radial-gradient(120% 120% at 100% 0%, rgba(59,130,246,.30), transparent 60%),
    linear-gradient(135deg, rgba(167,139,250,.15), rgba(236,72,153,.12));
  background-size:cover; background-position:center;
}
.kcard .meta{ display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:8px; }
.kcard .name{ margin:0; font-size:16px; font-weight:800; letter-spacing:-.01em; }
.kcard .tags{display:flex;gap:6px;flex-wrap:wrap}
.kcard .tags span{font-size:12px;color:var(--sub);border:1px solid var(--line);border-radius:999px;padding:2px 8px;background:var(--muted)}

/* Back content v2 */
.kcard .back{display:flex;flex-direction:column;gap:12px}
.back-hero{display:flex;gap:12px;align-items:center;padding:10px;border-radius:12px;
  background:
    radial-gradient(60% 120% at 0% 0%, color-mix(in oklab,var(--accent) 16%, transparent), transparent 70%),
    linear-gradient(180deg, color-mix(in oklab, var(--muted) 70%, transparent), transparent);
  border:1px solid var(--line);
}
.back-hero .fit{display:flex;flex-direction:column;align-items:center;gap:4px;min-width:64px}
.fit-ring{--p:84;--ringBg:rgba(128,128,128,.18); position:relative;width:56px;height:56px;border-radius:999px;
  background:conic-gradient(var(--accent) calc(var(--p)*1%), var(--ringBg) 0);
}
.fit-ring::after{content:"";position:absolute;inset:6px;border-radius:999px;background:var(--card)}
.fit-ring span{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px}
.back-hero em{font-style:normal;color:var(--sub);font-size:12px}
.back-hero .info{flex:1;min-width:0}
.back-hero .b-name{margin:0 0 4px;font-size:16px;font-weight:900;letter-spacing:-.01em}
.back-hero .kv{display:flex;flex-wrap:wrap;gap:6px}
.kv-chip{font-size:12px;color:var(--ink);background:color-mix(in oklab,var(--muted) 85%, transparent);
  border:1px solid var(--line);border-radius:999px;padding:2px 8px}
.kv-chip b{font-weight:800}

.benefit-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
@media (max-width:720px){ .benefit-grid{grid-template-columns:1fr} }
.b-item{position:relative;padding-left:22px;line-height:1.45}
.b-item::before{
  content:"";position:absolute;left:0;top:.35em;width:12px;height:12px;border-radius:50%;
  background:
    radial-gradient(circle at 30% 30%, #fff 1px, transparent 2px),
    radial-gradient(circle at 70% 70%, #fff 1px, transparent 2px),
    radial-gradient(closest-side, var(--accent) 98%, transparent 100%);
  box-shadow:0 0 0 2px color-mix(in oklab, var(--accent) 50%, transparent);
}
.kcard .actions{display:flex;gap:8px;margin-top:auto}

/* ===== Effects ===== */
.fx-glow .inner{position:relative}
.fx-glow .inner::after{
  content:""; position:absolute; inset:-1px; border-radius:18px; pointer-events:none;
  background:conic-gradient(from 180deg, color-mix(in oklab,var(--accent) 70%, transparent), transparent 40%, color-mix(in oklab,#60a5fa 60%, transparent));
  filter:blur(12px); opacity:.25; transition:opacity .2s ease, filter .2s ease; z-index:1;
}
.fx-glow:hover .inner::after{opacity:.45; filter:blur(16px)}
.kcard .sheen{position:absolute; inset:0; border-radius:18px; pointer-events:none; overflow:hidden}
.kcard .sheen::before{
  content:""; position:absolute; top:0; left:-120%; width:60%; height:100%;
  background:linear-gradient(120deg, transparent 0%, rgba(255,255,255,.28) 50%, transparent 100%);
  transform:skewX(-20deg); filter:blur(2px); transition:transform .6s ease; opacity:.35;
}
.fx-sheen:hover .sheen::before{ transform:translateX(260%) skewX(-20deg) }
.fx-gradient .inner{
  background:
    linear-gradient(var(--card), var(--card)) padding-box,
    linear-gradient(135deg, color-mix(in oklab,var(--accent) 70%, transparent), transparent) border-box;
  border:1px solid transparent;
}
.fx-gradient:hover .inner{ box-shadow:0 16px 32px rgba(0,0,0,.18) }
.fx-neon .inner{
  box-shadow:0 0 0 1px color-mix(in oklab,var(--accent) 60%, var(--line)),
             0 0 20px color-mix(in oklab,var(--accent) 30%, transparent);
}
.fx-neon:hover .inner{
  box-shadow:0 0 0 1px color-mix(in oklab,var(--accent) 80%, var(--line)),
             0 0 36px color-mix(in oklab,var(--accent) 42%, transparent);
}
.fx-slice .front::after{
  content:""; position:absolute; right:-10%; top:-10%; width:50%; height:40%;
  background:linear-gradient(135deg, color-mix(in oklab,var(--accent) 30%, transparent), transparent);
  border-radius:24px; filter:blur(10px); opacity:.25; transition:transform .25s ease, opacity .25s ease;
}
.fx-slice:hover .front::after{ transform:translate(-6px,6px) rotate(2deg); opacity:.4 }
.fx-float:hover .thumb{ transform:translateY(-2px); transition:transform .2s ease }

/* ===== A11y focus ===== */
.kcard :is(button,a):focus-visible{
  outline:2px solid color-mix(in oklab, var(--accent) 70%, #fff);
  outline-offset:2px; border-radius:10px;
}

/* ===== 배너 풀블리드 옵션(원하면 클래스만 추가) ===== */
.catalog-banner.is-bleed{
  max-width:none; margin:12px 0 20px; padding:0;
}
.catalog-banner.is-bleed .cb-shell{
  border-radius:0; border-left:0; border-right:0;
}
