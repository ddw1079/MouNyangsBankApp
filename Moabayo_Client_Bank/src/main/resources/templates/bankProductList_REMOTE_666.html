<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>모으냥즈 | 은행 상품 추천</title>
<link rel="icon" href="/images/cat.ico" type="image/x-icon" />
<!-- Page CSS -->
<link rel="stylesheet" th:href="@{/css/bank-products.css}" />

<!-- headr footer가 달리는 모든 페이지에 갖다 붙일것 -->
<link rel="icon" href="http://localhost:8810/images/cat.ico" type="image/x-icon" />
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="http://localhost:8810/css/header-footer.css" />
<script defer src="http://localhost:8810/js/token-exp-display.js"></script>
<script defer src="http://localhost:8810/js/common.js"></script>
<script defer src="http://localhost:8810/js/adminservice.js"></script>
<script defer src="http://localhost:8810/js/bankservice.js"></script>
<script defer src="http://localhost:8810/js/cardservice.js"></script>
<script defer src="http://localhost:8810/js/transactionservice.js"></script>
<!-- 이것도 같이 붙여야함 toggle switch 만들기 -->
<link rel="stylesheet" href="http://localhost:8810/css/theme.css">
<link rel="stylesheet" href="http://localhost:8810/css/toggle.css">
<script defer src="http://localhost:8810/js/theme.js"></script>

</head>
<body>
	<!-- 헤더/푸터는 외부에서 주입 -->
	<div id="header"></div>

	<main class="bank-products">
		<!-- Hero -->
		<section class="nx-hero">
			<div class="nx-hero__copy">
				<p class="hello">추천 상품</p>
				<h1 class="title">당신에게 맞는 은행 상품을 찾아보세요</h1>
				<p class="lead">검색 · 타입/카테고리 · 이율 범위 · 정렬 · 최대 6개 비교</p>
			</div>
			<div class="nx-hero__stats">
				<div class="stat">
					<div class="label">표시 상품</div>
					<div class="value" id="stat-visible">0</div>
				</div>
				<div class="stat">
					<div class="label">평균 이율</div>
					<div class="value" id="stat-avg">-</div>
				</div>
				<div class="stat">
					<div class="label">카테고리</div>
					<div class="value" id="stat-cats">-</div>
				</div>
			</div>
		</section>

		<!-- Filters -->
		<section class="filter-bar">
			<form class="filters" onsubmit="return false;">
				<input id="q" type="search" placeholder="이름/타입/카테고리/설명/혜택…" aria-label="검색" /> <select id="typeSel" aria-label="타입">
					<option value="">타입 전체</option>
					<option>Savings</option>
					<option>Checking</option>
					<option>Deposit</option>
					<option>Loan</option>
				</select> <select id="catSel" aria-label="카테고리">
					<option value="">카테고리 전체</option>
					<!-- 서버에서 categories 제공 시 아래 라인 유지 -->
					<option th:each="c : ${categories}" th:value="${c}" th:text="${c}">Savings</option>
				</select> <input id="minRate" type="number" step="0.01" min="0" placeholder="최소 이율(%)" aria-label="최소 이율"> <input id="maxRate" type="number" step="0.01" min="0" placeholder="최대 이율(%)" aria-label="최대 이율"> <select id="sortSel" aria-label="정렬">
					<option value="default">정렬: 기본</option>
					<option value="name-asc">이름 ↑</option>
					<option value="name-desc">이름 ↓</option>
					<option value="rate-asc">이율 ↑</option>
					<option value="rate-desc">이율 ↓</option>
				</select>
				<button id="resetBtn" class="btn btn-outline" type="button">초기화</button>
				<!-- 🔥 다크 토글/버튼 제거: 헤더에서 제어 -->
			</form>
		</section>

		<!-- Grid -->
		<!-- 기대 모델: products: List<BankProductVO{accountId,img,name,description,category,benefits,interest,type}> -->
		<section class="grid" id="grid">
			<div class="empty" id="empty" hidden>조건에 맞는 은행 상품이 없어요 😿</div>

			<div class="card-wrap" th:each="p : ${products}" th:data-id="${p.accountId}" th:data-name="${p.name}" th:data-type="${p.type}" th:data-category="${p.category}" th:data-rate="${p.interest}">
				<article class="product-card">
					<div class="img">
						<img th:if="${p.img != null}" th:src="${p.img}" alt=""> <img th:if="${p.img == null}" src="/images/account-placeholder.svg" alt="">
					</div>

					<div class="body">
						<div class="top">
							<span class="pill" th:text="${p.type}">Savings</span> <span class="rate" th:text="${#numbers.formatDecimal(p.interest,1,'POINT',2,'NONE')} + '%'">1.20%</span>
						</div>
						<h3 class="name" th:text="${p.name}">Standard Savings</h3>
						<div class="cat" th:text="${p.category}">Savings</div>
						<p class="desc" th:text="${p.description}">기본 예금 상품 설명…</p>
						<ul class="benefits">
							<li th:each="b : ${#strings.arraySplit(p.benefits, ',')}"><i>✔</i><span th:text="${#strings.trim(b)}">무이자 수수료</span></li>
						</ul>
					</div>

					<div class="foot">
						<a class="btn btn-dark flex" th:href="@{/bank/product(id=${p.accountId})}"> 자세히 </a>
						<button class="btn btn-outline" type="button" data-act="compare">비교</button>
					</div>
				</article>
			</div>
		</section>

		<!-- Compare bar -->
		<aside id="compareBar" class="compare">
			<div class="inner">
				<strong>비교함</strong>
				<div id="compareChips" class="chips"></div>
				<div class="ops">
					<button class="btn btn-ghost btn-sm" data-act="clear">비우기</button>
					<button class="btn btn-accent btn-sm" data-act="open">비교하기</button>
				</div>
			</div>
		</aside>
	</main>

	<!-- Compare modal (vanilla) -->
	<div class="modal" id="compareModal" hidden role="dialog" aria-modal="true" aria-labelledby="cmpTitle">
		<div class="modal-dim" data-act="close"></div>
		<div class="modal-box">
			<header class="modal-head">
				<h3 id="cmpTitle">은행 상품 비교</h3>
				<button class="btn btn-ghost btn-sm" data-act="close">닫기</button>
			</header>
			<div class="modal-body">
				<div class="table-wrap">
					<table class="ny-table">
						<thead>
							<tr>
								<th>이름</th>
								<th>타입</th>
								<th>카테고리</th>
								<th class="t-right">이율</th>
							</tr>
						</thead>
						<tbody id="compareTbody"></tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div id="footer"></div>
	<!-- Page JS -->
	<script defer th:src="@{/js/bank-products.js}"></script>
</body>
</html>
